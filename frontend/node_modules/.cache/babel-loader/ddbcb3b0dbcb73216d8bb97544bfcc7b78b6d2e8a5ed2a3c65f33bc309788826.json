{"ast":null,"code":"import React,{useEffect,useMemo,useState}from\"react\";import{AlertTriangle,RefreshCw,Shield}from\"lucide-react\";import api from\"../api/client\";/**\n * GovernanceTraceView\n *\n * Minimal view to support the `/governance-trace` route.\n * The backend endpoint for governance trace events may vary by deployment,\n * so this component is defensive: it tries a reasonable endpoint and shows\n * a helpful empty state if none is available.\n */import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function GovernanceTraceView(){const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[events,setEvents]=useState([]);const endpoint=useMemo(()=>\"/governance/trace\",[]);const load=async()=>{setLoading(true);setError(null);try{var _ref,_res$data$items,_res$data;const res=await api.get(endpoint);const items=(_ref=(_res$data$items=res===null||res===void 0?void 0:(_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.items)!==null&&_res$data$items!==void 0?_res$data$items:res===null||res===void 0?void 0:res.data)!==null&&_ref!==void 0?_ref:[];setEvents(Array.isArray(items)?items:[]);}catch(e){var _ref2,_e$response$data$deta,_e$response,_e$response$data,_e$response$data$deta2;setError((_ref2=(_e$response$data$deta=e===null||e===void 0?void 0:(_e$response=e.response)===null||_e$response===void 0?void 0:(_e$response$data=_e$response.data)===null||_e$response$data===void 0?void 0:(_e$response$data$deta2=_e$response$data.detail)===null||_e$response$data$deta2===void 0?void 0:_e$response$data$deta2.message)!==null&&_e$response$data$deta!==void 0?_e$response$data$deta:e===null||e===void 0?void 0:e.message)!==null&&_ref2!==void 0?_ref2:\"Request failed\");setEvents([]);}finally{setLoading(false);}};useEffect(()=>{load();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 max-w-6xl\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-lg font-semibold text-slate-100\",children:\"Governance Trace\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-slate-500 mt-0.5\",children:\"Event timeline and trace details for governance-related activity.\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:load,disabled:loading,className:\"flex items-center gap-2 px-3 py-1.5 text-xs bg-slate-800 hover:bg-slate-700 text-slate-300 rounded border border-slate-700 transition-colors disabled:opacity-40\",children:[/*#__PURE__*/_jsx(RefreshCw,{size:13,className:loading?\"animate-spin\":\"\"}),\"Refresh\"]})]}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 flex items-center gap-2 text-sm text-red-400 bg-red-500/10 border border-red-500/20 rounded px-4 py-2\",children:[/*#__PURE__*/_jsx(AlertTriangle,{size:15}),\" \",error]}),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"text-slate-500 text-sm animate-pulse\",children:\"Loading trace events\\u2026\"}),!loading&&!error&&events.length===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-[#111118] border border-slate-800 rounded-lg p-6 text-center\",children:[/*#__PURE__*/_jsx(Shield,{size:28,className:\"text-slate-700 mx-auto mb-3\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-slate-400\",children:\"No trace events available.\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-slate-600 mt-1\",children:[\"Expected endpoint: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-mono\",children:endpoint})]})]}),!loading&&events.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-[#0d0d14] border border-slate-800 rounded-lg overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-4 py-3 border-b border-slate-800\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-[10px] text-slate-500 font-mono uppercase tracking-widest\",children:[\"Events (\",events.length,\")\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"divide-y divide-slate-800/50\",children:events.map((ev,idx)=>{var _ref3,_ev$timestamp,_ref4,_ev$event_type,_ref5,_ev$event_id;const ts=(_ref3=(_ev$timestamp=ev===null||ev===void 0?void 0:ev.timestamp)!==null&&_ev$timestamp!==void 0?_ev$timestamp:ev===null||ev===void 0?void 0:ev.created_at)!==null&&_ref3!==void 0?_ref3:ev===null||ev===void 0?void 0:ev.occurred_at;const title=(_ref4=(_ev$event_type=ev===null||ev===void 0?void 0:ev.event_type)!==null&&_ev$event_type!==void 0?_ev$event_type:ev===null||ev===void 0?void 0:ev.type)!==null&&_ref4!==void 0?_ref4:\"event\";const id=(_ref5=(_ev$event_id=ev===null||ev===void 0?void 0:ev.event_id)!==null&&_ev$event_id!==void 0?_ev$event_id:ev===null||ev===void 0?void 0:ev.id)!==null&&_ref5!==void 0?_ref5:idx;return/*#__PURE__*/_jsx(\"div\",{className:\"px-4 py-3 hover:bg-slate-800/20 transition-colors\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-mono text-slate-200 truncate\",children:title}),(ev===null||ev===void 0?void 0:ev.message)&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-slate-500 mt-1\",children:String(ev.message)})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-[10px] text-slate-600 font-mono whitespace-nowrap\",children:ts?new Date(ts).toLocaleString():\"â€”\"})]})},id);})})]})]});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}